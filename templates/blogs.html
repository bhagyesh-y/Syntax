{% extends 'base.html' %} {% block content %}

<style>
  /* Article Typography & Layout */
  .blog-container {
    padding: 40px 0;
  }

  .entry-header h1 {
    font-family: "Playfair Display", serif;
    font-weight: 800;
    font-size: 2.5rem;
    color: #212529;
    line-height: 1.2;
  }

  .entry-meta {
    font-size: 0.9rem;
    color: #6c757d;
    border-bottom: 1px solid #eee;
    padding-bottom: 20px;
  }

  .featured-img-container {
    margin: 30px 0;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
  }

  .blog-body {
    font-size: 1.15rem;
    line-height: 1.8;
    color: #333;
  }

  .short-description {
    font-size: 1.25rem;
    color: #555;
    font-weight: 500;
    border-left: 4px solid #ffc107;
    padding-left: 20px;
    margin-bottom: 30px;
    font-style: italic;
  }

  /* Sidebar Widgets */
  .sidebar-widget {
    background: #fff;
    border-radius: 12px;
    border: none;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    margin-bottom: 30px;
    padding: 25px;
  }

  .widget-title {
    font-family: "Playfair Display", serif;
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 20px;
    border-bottom: 2px solid #ffc107;
    display: inline-block;
  }

  .category-list a,
  .social-list a {
    color: #495057;
    text-decoration: none;
    display: block;
    padding: 8px 0;
    transition: color 0.2s, transform 0.2s;
    font-size: 0.95rem;
  }

  .category-list a:hover,
  .social-list a:hover {
    color: #ffc107;
    transform: translateX(5px);
  }

  /* Badge Style */
  .badge-category {
    background-color: #ffc107 !important;
    color: #212529 !important;
    padding: 8px 16px;
    border-radius: 30px;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.5px;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .entry-header h1 {
      font-size: 1.8rem;
    }

    .blog-container {
      padding: 20px 0;
    }
  }

  /* Comments Section Styling */
  .comments-wrapper {
    margin-top: 50px;
    padding-top: 30px;
    border-top: 1px solid #eee;
  }

  .comment-count-title {
    font-family: "Playfair Display", serif;
    font-weight: 700;
    margin-bottom: 25px;
    position: relative;
    display: inline-block;
  }

  .comment-count-title::after {
    content: "";
    display: block;
    width: 40px;
    height: 3px;
    background: #ffc107;
    margin-top: 5px;
  }

  /* Individual Comment Cards */
  .comment-card {
    background: #fdfdfd;
    border: none;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
    margin-bottom: 15px;
    transition: transform 0.2s;
  }

  .comment-card:hover {
    transform: translateX(5px);
    background: #fff;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
  }

  .comment-user-info {
    font-weight: 700;
    color: #212529;
    font-size: 0.95rem;
  }

  .comment-date {
    font-size: 0.8rem;
    color: #adb5bd;
    margin-left: 10px;
  }

  /* Form Styling */
  .comment-form-container {
    background: #f8f9fa;
    padding: 30px;
    border-radius: 12px;
    margin-top: 40px;
  }

  .comment-textarea {
    border-radius: 8px;
    border: 1px solid #dee2e6;
    padding: 15px;
    resize: none;
    transition: all 0.3s;
  }

  .comment-textarea:focus {
    border-color: #ffc107;
    box-shadow: 0 0 0 0.2rem rgba(255, 193, 7, 0.15);
    outline: none;
  }

  .btn-comment {
    background: #212529;
    color: #fff;
    border: none;
    padding: 10px 25px;
    border-radius: 8px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 0.85rem;
    transition: all 0.3s;
  }

  .btn-comment:hover {
    background: #ffc107;
    color: #212529;
    transform: translateY(-2px);
  }

  .empty-comments {
    padding: 40px;
    text-align: center;
    background: #fff;
    border-radius: 12px;
    border: 2px dashed #eee;
    color: #6c757d;
  }
</style>

<div class="container blog-container">
  <div class="row">
    <div class="col-lg-8">
      <article>
        <header class="entry-header mb-4">
          <div class="mb-3">
            <a class="badge badge-category" href="#!">{{single_blog.category}}</a>
          </div>

          <h1>{{single_blog.title}}</h1>

          <div class="entry-meta mt-3">
            <i class="fa fa-calendar-o me-1"></i>
            {{single_blog.created_at|date:"M d, Y"}}
            <span class="mx-2">|</span>
            <i class="fa fa-user-circle-o me-1"></i> By
            <strong>{{single_blog.author}}</strong>
          </div>
        </header>

        <div class="featured-img-container">
          <img class="img-fluid w-100" src="{{ single_blog.featured_image.url }}" alt="{{single_blog.title}}" />
        </div>

        <section class="blog-body">
          <div class="short-description">
            {{ single_blog.short_description }}
          </div>

          <div class="main-content">{{ single_blog.blog_body|safe }}</div>
          <section class="comments-wrapper">
            <h4 class="comment-count-title">Comments ({{ comment_count }})</h4>

            <div class="mt-4">
              {% if comments %}
              {% for comment in comments %}
              <div class="card comment-card">
                <div class="card-body">
                  <div class="d-flex align-items-center mb-2">
                    <i class="fa fa-user-circle text-muted me-2" style="font-size: 1.2rem;"></i>
                    <span class="comment-user-info">{{ comment.user }}</span>
                    <span class="comment-date"><i class="fa fa-clock-o"></i> {{ comment.created_at|timesince }}
                      ago</span>
                  </div>
                  <p class="card-text text-secondary" style="line-height: 1.6;">{{ comment }}</p>
                </div>
              </div>
              {% endfor %}
              {% else %}
              <div class="empty-comments">
                <i class="fa fa-comments-o fa-2x mb-2 d-block"></i>
                Be the first one to share your thoughts on this story!
              </div>
              {% endif %}
            </div>

            <div class="comment-form-container mt-5">
              <h5 class="font-weight-bold mb-3">Leave a Reply</h5>
              {% if user.is_authenticated %}
              <form action="" method="post">
                {% csrf_token %}
                <div class="form-group">
                  <textarea name="comment" class="form-control comment-textarea mb-3" rows="4"
                    placeholder="Write your comment here..." required></textarea>
                  <button type="submit" class="btn btn-comment shadow-sm">
                    Post Comment <i class="fa fa-paper-plane ms-1"></i>
                  </button>
                </div>
              </form>
              {% else %}
              <div class="alert alert-light border d-flex align-items-center mb-0">
                <i class="fa fa-info-circle text-warning me-3 fa-lg"></i>
                <span>You must <a href="{% url 'login' %}" class="text-warning font-weight-bold">Login</a> to write a
                  comment.</span>
              </div>
              {% endif %}
            </div>
          </section>
        </section>
      </article>
    </div>

    <div class="col-lg-4">
      <div class="sidebar-widget">
        <h4 class="widget-title">Categories</h4>
        <div class="category-list">
          <div class="row">
            <div class="col-12">
              <ul class="list-unstyled mb-0">
                {% for cat in categories %}
                <li>
                  <a href="{% url 'posts_by_category' cat.id %}">
                    <i class="fa fa-angle-right me-2 text-warning"></i>
                    {{cat.category_name }}
                  </a>
                </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      </div>

      {% if social_links %}
      <div class="sidebar-widget">
        <h4 class="widget-title">Follow Us</h4>
        <div class="social-list">
          <ul class="list-unstyled mb-0">
            {% for i in social_links %}
            <li>
              <a href="{{ i.link }}" target="_blank">
                <i class="fa fa-{{ i.platform|lower }} me-2 text-warning"></i>
                {{i.platform }}
              </a>
            </li>
            {% endfor %}
          </ul>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}